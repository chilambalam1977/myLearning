%%
%% 章：美しい文書を書くために
%%------------------------------------------------------------------------------------------------------------------------------%%
\chapter{美しい文書を書くために}
ちょっとした書き方の違いで、素人と玄人の違いが出てしまう。
また、\LaTeX{}は自動的に殆どのことをやってくれるが、最終工程で視覚的な調整を行うと見栄えが格段と変わる。
本章では、そのような工夫をまとめてみた。
%%
%% 節：全角か半角か？
%%--------------------------------------------------------------------------------------------------------------------%%
\section{全角か半角か？}
全角文字とその半分の幅の半角文字しかなかった時代は終わり、今では「半角」「全角」文字と言っても欧文のプロポーショナル文字を指すことが多くなった。
\vspc{-0.50zw}\begin{longtable}[l]{@{}ll@{}}
  \hspc{+2.00zw}\textcolor{blue}{全角文字}         & ＷｉｎｄｏｗｓでＷｏｒｄを使う。\\
  \hspc{+2.00zw}\textcolor{blue}{昔の半角文字}     & \scalebox{0.95}[1]{Windows}で\scalebox{0.95}[1]{Word} を使う。\\
  \hspc{+2.00zw}\textcolor{blue}{今の「半角」文字} & WindowsでWord を使う。\\
\end{longtable}\vspc{-0.50zw}
全角・半角という呼び方が相応しくなくなったため、和文文字・欧文文字、あるいは 2 バイト文字・1 バイト文字という呼び方もされるようになったが、Unicode にするとバイト数も変わってしまう。\\

呼び方はともかく、少なくとも\TeX{}では、欧文や数字には欧文（半角）文字を使うのが鉄則である。
意見が分かれるのは「C言語」「朝8時」のような和文の文脈で使われる 1 文字だけの英数字で、この場合は全角を使いたくなるかもしれないが、一般には欧文文字で統一する方がよいだろう。
\vspc{-0.50zw}\begin{longtable}[l]{@{}lll@{}}
  \hspc{+2.00zw}\textcolor{blue}{半角}          & 午後5時55分    & BASICからC言語へ       \\
  \hspc{+2.00zw}\textcolor{blue}{全角}          & 午後５時５５分 & ＢＡＳＩＣからＣ言語へ \\
  \hspc{+2.00zw}\textcolor{blue}{1文字だけ全角} & 午後５時55分   & BASICからＣ言語へ      \\
\end{longtable}\vspc{-1.50zw}
%%
%% 節：句読点・括弧類
%%--------------------------------------------------------------------------------------------------------------------%%
\section{句読点・括弧類}
句読点や括弧の類は、和文では和文用（全角）を使うのが一般的である。
欧文用を使うと、全角を基本とする文字の並びが乱れてしまう。
\vspc{-0.50zw}\begin{longtable}[l]{@{}ll@{}}
  \hspc{+2.00zw}\textcolor{blue}{全角読点・全角句点}       & 地球は、青かった。 \\
  \hspc{+2.00zw}\textcolor{blue}{全角コンマ・全角句点}     & 地球は，青かった。 \\
  \hspc{+2.00zw}\textcolor{blue}{全角コンマ・全角ピリオド} & 地球は，青かった． \\
  \hspc{+2.00zw}\textcolor{blue}{半角コンマ・半角ピリオド} & 地球は, 青かった.  \\
\end{longtable}\vspc{-1.50zw}
特に括弧では、欧文用のものは g などの下の部分（descender）をカバーするために下に伸びているため、和文で使うと下にずれて見える。
\vspc{-0.50zw}\begin{longtable}[l]{@{}ll@{}}
  \hspc{+2.00zw}\textcolor{blue}{全角括弧} & 括弧（かっこ）だ。\\
  \hspc{+2.00zw}\textcolor{blue}{半角括弧} & 括弧 (かっこ) だ。\\
\end{longtable}\vspc{-1.50zw}
%%
%% 節：引用符
%%--------------------------------------------------------------------------------------------------------------------%%
\section{引用符}
和文用の引用符には、かぎ括弧「」、二重かぎ括弧『』などがある。
欧文用の ``ダブルクォート'' に相当するものとして、和文用（全角）の“ダブル引用符”もよく用いられる\footnote{昔の min10 などのフォントメトリックでは、バグのため全角の“引用符”の位置がおかしくなっていた。}。
%%
%% 節：疑問符・感嘆符
%%--------------------------------------------------------------------------------------------------------------------%%
\section{疑問符・感嘆符}
疑問符「？」や感嘆符「！」は、もともと日本語にはないもので、その扱いにも揺れがあるが、全角ものを用い、縦書きの場合には直後に全角（1zw）の空きを入れるのが標準的な組み方である。
横書きの場合は、特にルールはないが半角（0.5zw）程度の空きが適当なようである。\\

現在広く用いられている縦組用和文フォントメトリックの tmin10 や、otf パッケージの縦組用和文フォントメトリックでは「？」「！」の後の全角空きが自動的に挿入される。
横組では、otf パッケージのフォントメトリックでは半角の空きが挿入される。
後続の文字が句読点・終わり括弧（閉じ括弧類）・リーダー類（―、…、‥）の場合は空きは挿入されない。\\

横書きの jis フォントメトリックでは空きが入らないので「？」「！」の直後には半角スペースを入れるなどの工夫が必要である。
\vspc{-0.50zw}\begin{longtable}[l]{@{}ll@{}}
  \hspc{+2.00zw}\textcolor{blue}{jis フォントメトリック}              & あら！ほんと？ウッソー！！   \\
  \hspc{+2.00zw}\textcolor{blue}{jis フォントメトリック+半角スペース} & あら！ ほんと？ ウッソー！！ \\
  \hspc{+2.00zw}\textcolor{blue}{otf フォントメトリック}              & あら！ほんと？ウッソー！！   \\
\end{longtable}\vspc{-1.50zw}
otf パッケージのフォントメトリックで「？」「！」の直後に空きを入れないようにするには \verb'\<'（または \verb'\inhibitglue'）という命令を入れる。
\vspc{-1.50zw}\begin{longtable}[c]{@{}lcl@{}}
  \hspc{-6.00zw}\verb'あっ！\<と驚く。'\hspc{-1.00zw} & → & あっ！\<と驚く。 \\
\end{longtable}\vspc{-1.50zw}
%%
%% 節：自動挿入されるスペース
%%--------------------------------------------------------------------------------------------------------------------%%
\section{自動挿入されるスペース}
前述したように、和文のフォントメトリックによっては「？」「！」の直後に自動的にグルー（glue：伸縮するスペース）が入る。
グルー以外にも、和文のフォントメトリックによってカーン（kern：伸縮も行分割もしないスペース）が挿入される場合がある。\\

和文フォントメトリックからのグルー・カーンの挿入がない和文文字間には、\verb'\kanjiskip' というグルーが自動挿入される。
この \verb'\kanjiskip' の量はドキュメントクラスなどで定義されているが、段落ごとに自由に変更することができる。
例えば、
\vspc{+0.50zw}\begin{mdframed}[roundcorner=0.50zw,leftmargin=3.00zw,rightmargin=3.00zw,skipabove=0.40zw,skipbelow=0.40zw,innertopmargin=4.00pt,innerbottommargin=4.00pt,innerleftmargin=5.00pt,innerrightmargin=5.00pt,linecolor=gray!020,linewidth=0.50pt,backgroundcolor=gray!20]
\begin{verbatim}
\setlength{\kanjiskip}{0zw plus 0.15zw minus 0.05zw}
\end{verbatim}
\end{mdframed}\vspc{-0.70zw}
とすれば、$0^{+0.15}_{-0.05}$zw のグルーが挿入される。\\

この値は、段落（または \verb'\nbox{...}' などの箱）が閉じた時点での値が、段落（または箱）全体に適応されるため、次のような使い方の場合は中括弧を閉じる前に段落の区切りとなる空行（または、それと同じ意味を持つ \verb'par' という命令）を入れておく必要がある。
\vspc{-1.00zw}\begin{longtable}[c]{@{}lcl@{}}
  \hspc{-6.00zw}\verb'{\setlength{\kanjiskip}{0.5zw}すかすかに組む\par}' & → & す\hspc{+0.50zw}か\hspc{+0.50zw}す\hspc{+0.50zw}か\hspc{+0.50zw}に\hspc{+0.50zw}組\hspc{+0.50zw}む \\
\end{longtable}\vspc{-1.50zw}
また、和文・欧文間には \verb'\xkanjiskip' というグルーが挿入される。
この値は伝統的には全角の 1/4 に設定され、p\LaTeX{}標準では 0.25zw$\pm$1pt に設定されているが、雑誌などではゼロ、またはそれに近い値に設定されていることがよくある。
\vspc{-2.25zw}\begin{longtable}[c]{@{}lcl@{}}
  \hspc{-6.00zw}\verb'数学I実力テスト'                                    & → & 数学I実力テスト                                    \\
  \hspc{-6.00zw}\verb'\mbox{\setlength{\xkanjiskip}{0zw}数学I実力テスト}' & → & \mbox{\setlength{\xkanjiskip}{0zw}数学I実力テスト} \\
\end{longtable}\vspc{-1.50zw}
注意しなければならないことは、和文・欧文間に半角文字を入れたり入れなかったりすると、スペースの量がまちまちになるかもしれないことである。
半角空白のスペース（欧文の単語間スペース）の量は欧文フォントによって異なり、10 ポイントの Computer Modern Roman フォント（cmr, lmr）では $3.33^{+1.66}_{-1.11}$pt と広いのだが、昔からの Times や Palatino 相当フォント（ptm, ppl）なら $2.5^{+1.5}_{-0.6}$pt、\TeX{} Gyre 版（qtm, qpl）なら $2.5^{+1.25}_{-0.83}$pt 程度、更に新しい Nimbus15 の Times 相当フォントでは $2.5^{+2}_{-1}$pt である。\\

jsarticle や jsbook では \verb'\xkanjiskip' を ptm、ppl の単語間スペースと同じ $2.5^{+1.5}_{-0.6}$pt に設定してあるので、これらを用いる際は和欧文間には空白を入れても入れなくてもスペースの量は同じだが、Computer Modern フォントを使う際は、どちらかに統一する方がよいだろう。
但し、同じ Palatino でも pplj、pplx の語間は $2.91^{+1.75}_{-0.70}$pt である。
%%
%% 節：アンダーライン
%%--------------------------------------------------------------------------------------------------------------------%%
\section{アンダーライン}
``\verb|\underline{何々}|'' と入力すれば\underline{何々}のように下線（アンダーライン）を引くことができる。
しかし、アンダーラインはタイプライター時代の遺物であり推奨しないというのが\TeX{}の作者 Knuth 教授の考え方である。
そのためもあって、\TeX{}の \verb'\underline' はごく単純な作りになっており、いったん箱で囲むので伸び縮みや途中での改行ができない。
強調は欧文なら \emph{italic} 体や \textbf{boldface}、和文なら\.{圏}\.{点}や\textbf{太字}、\textgt{ゴシック体}を用いるのがよいだろう。
%%
%% 節：欧文の書き方
%%--------------------------------------------------------------------------------------------------------------------%%
\section{欧文の書き方}
欧文の場合に必要な、いくつかの注意点をまとめておく。
%%
%% 項：スペースの入れ方
%%----------------------------------------------------------------------------------------------------------%%
\subsection{スペースの入れ方}
欧文は、当然ながら欧文（半角）文字で記述する。
単語の区切りに半角空白を入れるのは当然だが、コンマやピリオドの後、括弧の外側にも必ず空白を入れる。
但し、句読点・疑問符・感嘆詞の直前、括弧・引用符の内側には空白を入れない。
\vspc{-0.50zw}\begin{longtable}[l]{@{}ll@{}}
  \hspc{+2.00zw}\textcolor{blue}{（誤）} & \verb'Red,green,and blue are colors(or colours).'    \\
  \hspc{+2.00zw}\textcolor{blue}{（正）} & \verb'Red, green, and blue are colors (or colours)'  \\
  \hspc{+2.00zw}\textcolor{blue}{（誤）} & \verb'Red, green, and blue are colors ( or colours)' \\
\end{longtable}\vspc{-1.50zw}
この単純なルールのおかげで、欧文では空白のあるところではどこでも改行することができ、特別な禁則処理（句読点や閉じ括弧が行頭に来ない処理）は不要である。
%%
%% 項：引用符
%%----------------------------------------------------------------------------------------------------------%%
\subsection{引用符}
欧文の ``Quote!'' のようなダブルクォートは、左シングルクォート（バッククォート）2 個と右シングルクォート 2 個で囲んで書く。
\vspc{-0.50zw}\begin{longtable}[l]{@{}llcl@{}}
  \hspc{+2.00zw}\textcolor{blue}{（誤）} & \verb|He said, "Hello."|   & → & He said, "Hello."   \\
  \hspc{+2.00zw}\textcolor{blue}{（正）} & \verb|He said, ``Hello.''| & → & He said, ``Hello.'' \\
\end{longtable}\vspc{-1.50zw}
次のような場合は、小さいスペースを出力する命令 \verb'\,' を区切りに入れる。
\vspc{-0.50zw}\begin{longtable}[l]{@{}lcl@{}}
  \hspc{+2.00zw}\verb|``He said, `Hello.'\,''| & → & ``He said, `Hello.'\,'' \\
  \hspc{+2.00zw}\verb|`He said, ``Hello.''\,'| & → & `He said, ``Hello.''\,' \\
\end{longtable}\vspc{-1.50zw}
%%
%% 項：2種類のスペース
%%----------------------------------------------------------------------------------------------------------%%
\subsection{2種類のスペース}
\TeX{}の流儀では、英語には単語間のスペースとセンテンス間のスペースが存在する。
以下で説明することがややこしければ、文書ファイルの最初の方に \verb'\frenchspacing' と記述しておくこと。
そうすることで、単語間もセンテンス間も同じスペースになる。
元に戻すコマンドは \verb'\nonfrenchspacing' である。\\

\TeX{}標準（\verb'\nonfrenchspacing'）では、10 ポイントの Times や Palatino（ptm, ppl）の単語間のスペースは 2.5~[pt]、センテンス間のスペースは 3.1~[pt]である（さらに伸び縮みする）。
\TeX{}は、ピリオドや感嘆符・疑問符・コロンでセンテンスの区切りを判断するが、例外として、大文字 1 文字の直後のピリオドは省略のピリオドと解釈され、通常の単語間の扱いになる。\\

次の例を見よ。
\vspc{-0.50zw}\begin{longtable}[l]{@{}lcl@{}}
  \hspc{+2.00zw}\verb|Hello.  I'm H.  Okumura.| & → & Hello.  I'm H.  Okumura. \\
\end{longtable}\vspc{-1.50zw}
Hello. の直後のスペースはセンテンス間のスペースである。
一方、I'm の直後のスペースや H. の直後のスペースは単語間のスペースである。\\

記号類は無視される。
例えば（``H''）\hspc{-4.00pt}. の直後のスペースは、大文字 1 文字 H の後なので単語間のスペースになる。
直前のアルファベットに関わらず、文末のスペースにするには \verb'\@' を用いる。
\vspc{-0.50zw}\begin{longtable}[l]{@{}llcl@{}}
  \hspc{+2.00zw}\textcolor{blue}{（誤）} & \verb|I watch TV.   It's fun.| & → & I watch TV.   It's fun. \\
  \hspc{+2.00zw}\textcolor{blue}{（旧）} & \verb|I watch TV\@. It's fun.| & → & I watch TV\@. It's fun. \\
  \hspc{+2.00zw}\textcolor{blue}{（新）} & \verb|I watch TV.\@ It's fun.| & → & I watch TV.\@ It's fun. \\
\end{longtable}\vspc{-1.50zw}
この最後の形は jsarticle、jsbook 専用の書き方である。
2 番目の古い書き方では V とピリオドのカーニングがうまくいかない。\\

直前のアルファベットに関わらず単語間のスペースにするには \verb'\'\textvisiblespace{}とする。
\vspc{-0.50zw}\begin{longtable}[l]{@{}llcl@{}}
  \hspc{+2.00zw}\textcolor{blue}{（誤）} & \verb|FooBar Co., Ltd. is cool.|  & → & FooBar Co., Ltd. is cool.  \\
  \hspc{+2.00zw}\textcolor{blue}{（正）} & \verb|FooBar Co., Ltd.\ is cool.| & → & FooBar Co., Ltd.\ is cool. \\
  \hspc{+2.00zw}\textcolor{blue}{（誤）} & \verb|Mr. and Mrs. Okumura|       & → & Mr. and Mrs. Okumura       \\
  \hspc{+2.00zw}\textcolor{blue}{（正）} & \verb|Mr.\ and Mrs.\ Okumura|     & → & Mr.\ and Mrs.\ Okumura     \\
  \hspc{+2.00zw}\textcolor{blue}{（誤）} & \verb|Mr.~and Mrs.~Okumura|       & → & Mr.~and Mrs.~Okumura       \\
\end{longtable}\vspc{-1.50zw}
最後の例のように、行分割しない空白 \verb'~' も必ず単語間のスペースの広さになる。
Mr.~の直後では改行してほしくないことが多いので、この場合は \verb'~' を使うのがよいだろう。\\
%%
%% 節：その他の調整
%%--------------------------------------------------------------------------------------------------------------------%%
\section{その他の調整}
%%
%% 項：改行幅の調整
%%----------------------------------------------------------------------------------------------------------%%
\subsection{改行幅の調整}
仕上がりを見てから調節しなければならない例として、$\displaystyle{\frac{f(x)}{\int^{\infty}_{-\infty}{f(x)}\,dx}}$ のような大きな数式による改行の乱れがある。\\

この場合、すぐ下の行に何もなければ、インライン数式を \verb'\smash{$...$}' のように全体を \verb'\smash' で囲んで改行幅が乱れないようにすることができる。
このような調整は必須ではないが、見苦しい場合は適用することがある。
%%
%% 項：図の調整
%%----------------------------------------------------------------------------------------------------------%%
\subsection{図の調整}
\begin{wrapfigure}{r}{6zw}
  \vspace*{-\intextsep}
  \includegraphics[width=6zw]{./Fig/Fig09_01.PNG}
\end{wrapfigure}
\LaTeX{}は組版から図の配置までを自動で行ってくれるが、特に図がたくさん入る場合は、自動ではなかなか人間の美意識に叶う配置ができない。
最終段階で視覚的な調整が必要となる。
これについては第 9 章で述べた。\\

例えば、右のように図にテキストを回り込ませる場合、図がテキストの上端や、回り込みのないテキストの右端など、顕著な位置にぴったり揃うようにすると整った感じがする。
このようなルールを破って大胆に配置することもあるが、中途半端にずれていると素人組版に見えてしまう。
